<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" ; integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
<link rel="stylesheet" href="//malihu.github.io/custom-scrollbar/jquery.mCustomScrollbar.min.css">
<link rel="stylesheet" href="css/main.css">
<link rel="stylesheet" href="css/sidebar-themes.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.css">



<div class="container-fluid p-3">
        <div class="container shadow-lg p-3 mb-5 bg-dark rounded">
            <canvas class="overflow-auto" id="ramChart-a" width="500px"></canvas>
        </div>
    
        <div class="container shadow-lg p-3 mb-5 bg-dark rounded">
            <canvas class="overflow-auto" id="ramChart-b" width="500px"></canvas>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" charset="utf-8"></script>
    <script type="text/javascript">
        const requestData = arg => {
            $.get('/computadores', results => {
            if (!results.success) throw new Error('Computadores Falhou');
    
            $.post('/desempenhos', {idComputador: results.data.idComputador}, desempenhos => {
                let res = {
                    ram: [],
                    total: desempenhos.data.somas.nrRam
                };
    
                desempenhos.data.desempenho.map(dsp => res.ram.push(dsp.nrRam));

                return res.ram;
                });
            });
        }
    
        const chartA = res => { 
            const chartramA = new Chart(document.getElementById('ramChart-a'), {
                type: 'bar',
                data: {
                    labels: ['Consumo de RAM'],
                    datasets: [{
                        label: 'Consumo',
                        data: res,
                        backgroundColor: 'rgba(255,179,71,0.1)',
                        borderColor: 'rgb(255,179,71)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    title: {
                        display: true,
                        text: 'Consumo de RAM',
                        position: 'top',
                        fontColor: "",
                    },
                    scales: {
                        xAxes: {
                            gridLines: {
                                offsetGridLines: true
                            }
                        },
                        yAxes: {
                            display: true,
                            ticks: {
                                min: 0,
                                steps: 10,
                                max: 100
                            }
                        }
                    },
                }
            });
            setTimeout(async () => {
                chartramA.data.datasets.data = await requestData();
            });
        };
    
        const chartB = res => {
            const chartramB = new Chart(document.getElementById('ramChart-b'), {
                type: 'bar',
                data: {
                    labels: ['Média da RAM'],
                    datasets: [{
                        label: 'Temperatura',
                        data: res/12,
                        backgroundColor: 'rgba(255,179,71,0.1)',
                        borderColor: 'rgb(255,179,71)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    title: {
                        display: true,
                        text: 'Média atual de RAM',
                        position: 'top',
                        fontColor: "",
                    },
                    scales: {
                        xAxes: [{
                            gridLines: {
                                offsetGridLines: true
                            }
                        }],
                        yAxes: [{
                            display: true,
                            ticks: {
                                min: 0,
                                steps: 10,
                                max: 100
                            }
                        }]
                    },
                }
            });
        };
    
        $.get('/computadores', results => {
            if (!results.success) throw new Error('Computadores Falhou');
    
            $.post('/desempenhos', {idComputador: results.data.idComputador}, desempenhos => {
            let res = {
                ram: [],
                total: desempenhos.data.somas.nrRam
            }
    
            desempenhos.data.desempenho.map(dsp => {
                res.ram.push(dsp.nrRam);
            });
    
                console.log(res.ram);
                chartA(res.ram);
                console.log(res.temp);
                chartB(res.total);
            });
        });
    </script>