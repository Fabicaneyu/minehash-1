<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" ; integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
<link rel="stylesheet" href="//malihu.github.io/custom-scrollbar/jquery.mCustomScrollbar.min.css">
<link rel="stylesheet" href="css/main.css">
<link rel="stylesheet" href="css/sidebar-themes.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.css">
<!-- <link rel="stylesheet" href="iziToast.min.css"> -->
<!-- <script src="iziToast.min.js" type="text/javascript"></script> -->
<div class="container-fluid p-3">
    <div class="container d-flex justify-content-between mb-3 text-white">
        <div class="container shadow-lg p-5 mr-md-5 bg-dark rounded" id="card">
            <canvas class="overflow-auto" id="cpuChart" width="300px"></canvas>
        </div>

        <div class="container shadow-lg p-5 mr-md-5 bg-dark rounded">
            <canvas class="overflow-auto text-white" id="gpuChart" width="300px"></canvas>
        </div>
    </div>

    <div class="container d-flex justify-content-between mb-3   ">
        <!-- consumo CPU -->
        <div class="container shadow-lg p-5 mr-md-5 bg-dark text-white rounded" id="card">
            <canvas class="overflow-auto" id="ramChart" width="300px"></canvas>
        </div>

        <div class="container shadow-lg p-5 mr-md-5 bg-dark rounded">
            <canvas class="overflow-auto" id="diskChart" width="300px"></canvas>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Script Chart CPu -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" charset="utf-8"></script>
<script>
    // const startChartPct = (media, somatorio, opts) => {
    //   calc = somatorio / media;
    //   const chart = new Chart(document.getElementById(opts.id), { //cpuChart
    //     type: 'doughnut',
    //     data: {
    //       labels: ['Média Consumida', 'Média não consumida'],
    //       datasets: [{
    //         label: 'Média de consumo dos últimos 7 dias',
    //         data: [calc, 100 - calc],
    //         backgroundColor: [
    //           'rgb(255,179,71)',
    //           'rgb(105, 113, 121, 0.85)',
    //         ],
    //         borderColor: [
    //           'rgb(255,179,71)',
    //           'rgb(105, 113, 121, 1)',
    //         ],
    //         borderWidth: 1
    //       }]
    //     },
    //     options: {
    //       circumference: 1 * Math.PI,
    //       rotation: 1 * Math.PI,
    //       responsive: true,
    //       title: {
    //         display: true,
    //         text: 'CPU',
    //         position: 'top',
    //         fontColor: "white",
    //       },
    //       legend: {
    //         labels: {
    //           fontColor: "white",
    //           title: 'Média de CPU'
    //         }
    //       }
    //     }
    //   });
    // };

    const startChart = (media, somatorio, opts) => {
        calc = somatorio / media;
        const chart = new Chart(document.getElementById(opts.id), { //cpuChart
            type: 'doughnut',
            data: {
                labels: opts.labels,
                datasets: [{
                    data: [calc, 100 - calc],
                    backgroundColor: [
                        'rgba(255,179,71, 0.85)',
                        'rgb(105, 113, 121, 0.85)',
                    ],
                    borderColor: [
                        'rgba(255,179,71,1)',
                        'rgb(105, 113, 121, 1)',
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                circumference: 1 * Math.PI,
                rotation: 1 * Math.PI,
                responsive: true,
                title: {
                    display: true,
                    text: opts.title,
                    position: 'top',
                    fontColor: "white",
                },
                legend: {
                    labels: {
                        fontColor: "white"
                    }
                }
            }
        });
    };

    $.get('/computadores', (results, status) => {
        console.log(results);
        if (!results.success && results.data == null) return console.error('Requisição Mal-sucedida.');

        return $.post('/desempenhos', {
            idComputador: results.data.idComputador
        }, results => {

            startChart(results.data.media, results.data.somas.nrCpu, {
                id: 'cpuChart',
                labels: ['Consumido', 'Total Restante'],
                title: 'Processador'
            });

            startChart(results.data.media, results.data.somas.nrGpu, {
                id: 'gpuChart',
                labels: ['Consumido', 'Total Restante'],
                title: 'Placa de Vídeo'
            });

            startChart(results.data.media, results.data.somas.nrRam, {
                id: 'ramChart',
                labels: ['Consumido', 'Livre'],
                title: 'Memória RAM'
            });

            startChart(results.data.media, results.data.somas.nrDisco, {
                id: 'diskChart',
                labels: ['Espaço Usado', 'Espaço Livre'],
                title: 'Armazenamento'
            });


        });
    });
</script>


<script>
    iziToast.settings({
        timeout: 10000,
        resetOnHover: true,
        icon: 'material-icons',
        transitionIn: 'flipInX',
        transitionOut: 'flipOutX',
        onOpening: function() {
            console.log('callback abriu!');
        },
        onClosing: function() {
            console.log("callback fechou!");
        }
    });
</script>







<script>
    iziToast.show({
        theme: 'dark',
        icon: 'icon-person',
        title: 'Hey',
        message: 'Welcome!',
        position: 'center', // bottomRight, bottomLeft, topRight, topLeft, topCenter, bottomCenter
        progressBarColor: 'rgb(0, 255, 184)',
        buttons: [
            ['<button>Ok</button>', function(instance, toast) {
                alert("Hello world!");
            }, true], // true to focus
            ['<button>Close</button>', function(instance, toast) {
                instance.hide({
                    transitionOut: 'fadeOutUp',
                    onClosing: function(instance, toast, closedBy) {
                        console.info('closedBy: ' + closedBy); // The return will be: 'closedBy: buttonName'
                    }
                }, toast, 'buttonName');
            }]
        ],
        onOpening: function(instance, toast) {
            console.info('callback abriu!');
        },
        onClosing: function(instance, toast, closedBy) {
            console.info('closedBy: ' + closedBy); // tells if it was closed by 'drag' or 'button'
        }
    });
</script>